from typing import List

# 3043. Find the Length of the Longest Common Prefix

# You are given two arrays with positive integers arr1 and arr2.

# A prefix of a positive integer is an integer formed by one or more of its digits, starting from its leftmost digit. For example, 123 is a prefix of the integer 12345, while 234 is not.

# A common prefix of two integers a and b is an integer c, such that c is a prefix of both a and b. For example, 5655359 and 56554 have a common prefix 565 while 1223 and 43456 do not have a common prefix.

# You need to find the length of the longest common prefix between all pairs of integers (x, y) such that x belongs to arr1 and y belongs to arr2.

# Return the length of the longest common prefix among all pairs. If no common prefix exists among them, return 0.

 

# Example 1:

# Input: arr1 = [1,10,100], arr2 = [1000]
# Output: 3
# Explanation: There are 3 pairs (arr1[i], arr2[j]):
# - The longest common prefix of (1, 1000) is 1.
# - The longest common prefix of (10, 1000) is 10.
# - The longest common prefix of (100, 1000) is 100.
# The longest common prefix is 100 with a length of 3.
# Example 2:

# Input: arr1 = [1,2,3], arr2 = [4,4,4]
# Output: 0
# Explanation: There exists no common prefix for any pair (arr1[i], arr2[j]), hence we return 0.
# Note that common prefixes between elements of the same array do not count.
 

# Constraints:

# 1 <= arr1.length, arr2.length <= 5 * 104
# 1 <= arr1[i], arr2[i] <= 108

class Solution:
    def commonPrefix(self, arr1: List[int], arr2: List[int]) -> int:
        # all pairs  loop arr1  arr2
        # helper to fix prefix
        # res >= max len of x or y : break
       
        def helper(int1, int2):
            st1, st2 = str(int1), str(int2)
            ct = 0
            for i in range(min(len(st1), len(st2))):# 0 ~ 2 i = 2
                if st1[i] == st2[i]:
                    ct += 1  # 3
                else:
                    break
            return ct # 3
        #arr1 = [1,10,100], arr2 = [1000]
        arr1.sort()
        arr2.sort()
        l1 = len(arr1) # 3
        l2 = len(arr2) # 1
        res = 0
        for i in range(l1, -1, -1): # 2 ~ 0  i = 0   11
            if res >= len(str(arr1[i])):
                return res
            for j in range(l2, -1, -1): # 0 j = 0     1000
                if res >= len(str(arr2[j])):# 3 >= 1
                    return res
                l_pre = helper(arr1[i], arr2[j]) # 100, 1000  # 3
                res = max(res, l_pre) # 3
        return res # 3
    # time complexity O(nlogn + m * n * k) n is the max(l1, l2) m is another length -> worest case O(m * n)  best case O(nlogn)
    # space complexity O(1)

# [2953594,8756782,4617582,6586279,5510316,3408181,5740402,4258004,1640729,8369780,9565586,4659714,7475316,9279836,9309875,8913746,5767526,2605124,7871977,1288226,7323011,7172420,2226666,2461505,1498957,2655297,5632315,2948333,6878587,4431988,9641420,2907665,3122405,6968042,6830254,7272331,9392334,1486413,3861563,2349258,7160131,3679870,8156100,2411862,1458980,8928128,9492223,7893533,7986622,7144416,5785285,7740386,6670606,6673073,4465361,2831855,2120112,9486731,2819128,1623350,9255721,1404141,7377155,4813319,6422592,3831981,2659974,8741718,9586853,6861151,8366231,1589259,8590068,8415388,9555110,6312538,2531419,6872766,2215177,4160599,9740960,5712871,7747951,4488579,7718535,9102014,3196787,3793260,3966488,3119579,6973693,9345743,2810516,1242357,5672203,8790480,2613393,7985635,2785140,9501006,6349326,8184127,7913685,4312236,3559999,4343623,1257783,8274799,1696488,1963924,5650841,7466682,1598915,7930827,3583996,5336953,7390199,3466765,1372120,1327937,7485974,9689948,6611205,8694349,6186709,2316367,7673676,3438794,1472723,3718687,9465312,5443798,9378009,6871271,3428914,1434712,1426981,4468298,9222693,3119320,9641807,9526601,3302493,5837005,8575050,8744050,3371128,3619580,3407231,1870210,4482385,5290007,7301827,9291879,8328463,5430364,7636966,9302417,8931956,7134739,7829630,3635998,6367238,7323564,4798879,7212831,5834606,7689576,9672775,7925131,3419410,9581839,3544808,2897254,4207985,5824638,9743217,2215148,9773902,5569985,6609247,2193177,1227168,5288996,6210133,2131238,2344266,6119510,1230757,8473171,6398916,6791705,6420406,1526200,5341096,5256437,5214951,5299489,1251776,7969990,5571192,5883334,7705103,7799007,1182916,4400032,1598639,1579722,9232139,9717940,9186426,6222607,4678368,2170389,8966410,7690061,2619715,7756182,3553793,8473417,7112029,6464971,2935606,1924712,7446722,3585786,3439635,6992839,6338067,7660856,4149783,4787699,3714328,8794512,7359928,6331791,2266216,8602413,5894090,6364521,2946397,3522180,6843463,8351146,8267830,5774719,8964132,4952981,4771051,4320847,5410058,1880392,1935239,8537295,7271465,6579409,9612520,8574904,1861848,4334674,2856644,5467245,1866711,6847441,9615895,9260315,5105995,7118351,8567245,1236656,8389859,3684360,6767220,1176298,3239129,1260977,9231624,7251669,9332214,3986459,5860386,2698356,6547190,4908184,9637767,7353691,9299206,1653781,3836007,5259519,2693745,8235277,5815622,1658920,4528176,5574596,4179697,4867594,8932377,4654242,9829982,3230061,7666789,6237269,6927198,5598417,5321649,8892057,1844232,9589633,7836150,3731787,1323128,9102137,9628342,9213103,4544467,4871349,4754757,3285214,9640985,1396044,1277471,3429233,4868331,1874601,1429930,9617276,3445879,4419860,2522510,1155752,1970368,8723034,3702076,3654076,1263846,9425592,9994867,3851438,7963598,2633512,2869763,3498469,9999815,1471868,6969146,8456736,8927859,2742150,3159597,2860600,9932363,1136444,2331772,6847500,8719006,6201533,8410803,6442092,6393127,9136345,5629297,4278925,5570396,5238934,1249161,8138373,3631423,8619590,3481170,7725834,1964722,5910153,2780432,7991488,2346111,6838625,2164988,3726378,2112779,1547102,2340560,9551036,8569168,1597603,7445686,2990987,8389747,9291184,7233395,9211318,7563562,5216310,7349953,1906806,4625974,1356467,4892578,2196677,1661965,9122930,6497108,3786952,2284287,9939999,6760822,3186534,8460185,7145195,6382417,1148372,1213487,7331867,6954839,1916153,9951618,4886155,1466411,6634605,2414441,5529941,1590132,9672022,7226080,1623864,7421309,4161618,5475119,7887458,8806663,9104757,7630189,1178021,8527008,1371267,8870751,6491422,7729717,1807146,4184092,6689207,2106465,1684233,9325013,2768083,4418324,7573363,7516222,2358229,6251611,8265459,8524459,7136502,9292860,4880301,7840449,4438794,2535651,8529496,7117999,8345132,7959462,8608877,6368918,9115277,3550641,7472556,1304583,2523384,6356331,2994353,7421137,1235779,6779074,9176011,5691048,4559313,1732226,2961852,4863254,8314828,9926672,9374822,9874716,8625037,5738406,5321324,9174848,9753110,4150724,5784959,4292889,5885917,9247708,5612863,1658137,8828457,2514803,4542331,5533325,4687817,1834686,5953110,5661357,1376165,9486028,9300231,8965033,1544107,6251860,2961912,4194508,2924700,1275261,2714860,2117985,3830077,6269010,7214146,2945661,5998912,4314753,6212102,6416509,4363979,9568469,2623225,7169628,7108308,1690969,4577118,2352043,7141756,6739152,1694476,6294274,7642904,9582027,3475076,7358364,3780943,2157614,6713919,8910263,9267072,1659459,4718685,7464762,5223233,4451280,7597750,3789081,6265467,3990250,9592467,8738356,2596969,1472197,7362614,6923550,1979635,5866766,8948741,7483346,1294146,6648829,2819883,5843375,2121626,7534304,9676179,2153128,4587554,8199442,9651250,5442490,3326421,3885879,7643492,6661086,7280200,5198215,6715045,6870969,2555913,3110329,6696329,1671331,7679094,6849984,5112503,8815487,8176579,2572199,1851330,9474544,6617842,2502130,5774382,6772874,3592897,7442657,1899770,2710820,1937432,2490638,2486337,5402170,6192877,3783277,2197251,4955801,8302302,2648656,6315659,5936242,5886841,2297871,5938034,2446221,9932884,5585894,5863084,3167028,4316161,1678087,8234845,8313405,9146537,8562858,7166368,8243632,9452659,5425680,9624575,2137690,7524103,2697505,1247399,1865907,3983587,7789719,2672135,6300209,4744137,5936144,2742819,1512813,6652525,9987255,5396270,7138256,3295755,5440084,3534028,1427214,8924742,7569059,4228539,6317436,8410537,7978017,6791914,6172940,4698515,8113875,7214409,2433207,3268197,1679221,8826249,4643599,8194426,8212001,2370311,5452351,1466210,4781358,4374003,1285268,8254076,1279803,1969435,7834163,5516802,7529796,1475072,9770162,5215378,4642809,5219677,1388427,6199730,2733639,3174236,9259418,8632590,9632490,3619916,4221361,9464644,8949693,3218701,8977663,3920488,9538316,2388690,6981374,8386832,3499464,1613837,8584690,1884103,8948149,6938505,8866986,3753383,9996793,4656505,2907499,5336885,4380311,9278857,5594344,5320443,7589742,9618659,4743879,4397829,9788065,8913822,5602218,5963224,2826557,9121858,1422735,7423503,4217531,9346177,8289486,5775352,3869632,2432254,6758610,7218215,6870916,8936232,9967694,4374817,8871007,7520044,8176431,6639473,8224471,3875319,6894547,1645144,4992736,2675501,5167006,9738538,7767837,3734026,5598621,4837692,4336767,1411017,1470159,9268536,3235935,5282726,8320151,6227168,2331204,3760187,3558356,5275672,9781282,9295249,9517282,4859207,9699471,7275002,6514881,1431062,6834720,8633743,9776009,7497843,7600859,8981424,6508744,8896189,4445233,6853233,6383939,6857346,2855138,5224168,4594881,5457625,1442559,4156641,7926246,6152578,6160565,1479191,7997498,8575388,8132487,3921930,3698354,6898762,5262586,2447617,2220541,4568914,8326124,7831356,7140583,6474331,6672949,4811382,8613212,5452049,5455920,1197643,1316645,2831885,6160898,5974663,2977448,4136478,5520340,8570290,4982530,6680951,7455460,3306987,3571342,5986376,3774556,2183209,1271512,2395803,7747053,3578890,8644168,2189582,1821611,2536536,3289786,4178333,4728905,3382185,3826687,8961837,6720907,2842572,5955456,4930356,1572789,5964969,4185281,9859131,9725883,1719633,1363050,6785439,7720250,9273771,4846050,2443296,4975802,5843970,5236996,1737949,2872552,4917961,7780238,4365708,9794313,3356373,1129853,6410938,4423617,8383163,3483290,2598955,2965893,3326128,8166420,8710768,6789426,3428930,4589460,5388139,5755075,2852160,6616262,1476818,3781248,3522809,7980464,8772741,1914239,9697075,5217279,8875032,5271858,3614158,1120610,5113579,4981871,8600462,2650679,8903446,3103806,1335372,5513305,1269663,6416417,1283938,5432766,8791088,8241389,8932431,9339801,5391771,2801948,2426846,4734758,4126810,4425718,7180178,6758413,6929589,7421165,2932162,2222581,1296679,6648202,9441296,2222722,6931074,5654331,1328176,9635385,7817625,8812562,9286149,2992534,1453983,9799664,1693700,6680317,3393864,7484966,3995907,7142455,9169465,7811380,6228297,8720255,9569410,3215816,5886556,7172446,2387940,6270780,4613215,6117395,5906483,6702542,5450229,5109086,4509698,3227247,7420805,7536012,8718306,2171636,2853208,1434697,2826815,8617171,8552236,4650318,4670792,2905824,7244873,2547543,8124864,6675664,8678130,4818454,5970399,2641977,9979257]


class Solution:
    def longestCommonPrefix(self, arr1, arr2):
        arr1_prefixes = set()  # Set to store all prefixes from arr1

        # Step 1: Build all possible prefixes from arr1
        for val in arr1:
            while val not in arr1_prefixes and val > 0:
                # Insert current value as a prefix
                arr1_prefixes.add(val)
                # Generate the next shorter prefix by removing the last digit
                val //= 10

        longest_prefix = 0

        # Step 2: Check each number in arr2 for the longest matching prefix
        for val in arr2:
            while val not in arr1_prefixes and val > 0:
                # Reduce val by removing the last digit if not found in the prefix set
                val //= 10
            if val > 0:
                # Length of the matched prefix using log10 to determine the number of digits
                longest_prefix = max(longest_prefix, len(str(val)))

        return longest_prefix

# Let m be the length of arr1, n be the length of arr2, M be the maximum value in arr1, and N be the maximum value in arr2.

# Time Complexity: O(m⋅log10M + n⋅log10N)

# For each number in arr1, we repeatedly divide the number by 10 to generate its prefixes. Since dividing a number by 10 reduces the number of digits logarithmically, this process takes O(log 
# 10
# ​
#  M) for each number in arr1. Hence, for m numbers, the total time complexity is O(m⋅log 
# 10
# ​
#  M).

# Similarly, for each number in arr2, we reduce it by repeatedly dividing it by 10 to check if it matches any prefix in the set. This also takes O(log 
# 10
# ​
#  N) for each number in arr2. Hence, for n numbers, the total time complexity is O(n⋅log 
# 10
# ​
#  N).

# Overall, the total time complexity is O(m⋅log 
# 10
# ​
#  M+n⋅log 
# 10
# ​
#  N).



class TrieNode:
    def __init__(self):
        # Each node has up to 10 possible children (digits 0-9)
        self.children = [None] * 10


class Trie:
    def __init__(self):
        self.root = TrieNode()

    # Insert a number into the Trie by treating it as a string of digits
    def insert(self, num):
        node = self.root
        num_str = str(num)
        for digit in num_str:
            idx = int(digit)
            if not node.children[idx]:
                node.children[idx] = TrieNode()
            node = node.children[idx]

    # Find the longest common prefix for a number in arr2 with the Trie
    def find_longest_prefix(self, num):
        node = self.root
        num_str = str(num)
        len = 0

        for digit in num_str:
            idx = int(digit)
            if node.children[idx]:
                # Increase length if the current digit matches
                len += 1
                node = node.children[idx]
            else:
                # Stop if no match for the current digit
                break
        return len


class Solution:
    def longestCommonPrefix(self, arr1, arr2):
        trie = Trie()

        # Step 1: Insert all numbers from arr1 into the Trie
        for num in arr1:
            trie.insert(num)

        longest_prefix = 0

        # Step 2: Find the longest prefix match for each number in arr2
        for num in arr2:
            len = trie.find_longest_prefix(num)
            longest_prefix = max(longest_prefix, len)

        return longest_prefix